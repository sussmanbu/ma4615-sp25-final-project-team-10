---
title: "Blog Post 8"
description: "Interactive exploration of Cook County exonerations and crime data"
author: "Team 10 (Mango)"
date: "2025-03-24"
format: html
editor: visual
execute:
  echo: true
  message: false
  warning: false
runtime: shiny
---


```{r}
# Load libraries and cleaned data
library(tidyverse)
library(here)

exon <- read_rds(here("dataset", "exoneration_data_cook.rds"))
crime <- read_rds(here("dataset-ignore", "crime_data_2010.rds"))

# 1. Prepare exoneration trends by year
exon_trends <- exon %>%
  mutate(Exonerated = as.integer(Exonerated)) %>%
  filter(!is.na(Exonerated)) %>%
  count(Year = Exonerated) %>%
  mutate(Data = "Exonerations")

# 2. Map crime types to broader categories
violent_types <- c(
  "HOMICIDE", "CRIM SEXUAL ASSAULT", "SEX OFFENSE", "OFFENSE INVOLVING CHILDREN",
  "ASSAULT", "ROBBERY"
)

crime_cat <- crime %>%
  mutate(Category = if_else(`Primary Type` %in% violent_types, "Violent", "Nonviolent"))

# 3. Summarize crime trends by year
crime_trends <- crime_cat %>%
  count(Year, Category) %>%
  # total crimes per year for comparison
  group_by(Year) %>%
  summarize(Count = sum(n), .groups = "drop") %>%
  mutate(Data = "Crimes")

# 4. Combine both trends into one dataset
combined_trends <- bind_rows(
  exon_trends %>% rename(Count = n),
  crime_trends
)

# 5. Plot both on the same chart
ggplot(combined_trends, aes(x = Year, y = Count, color = Data)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Cook County: Crimes vs Exonerations Over Time",
    x = "Year",
    y = "Count",
    color = "Data Type"
  ) +
  theme_minimal()

library(tidyverse)
library(here)

# Load cleaned data
exon <- read_rds(here("dataset", "exoneration_data_cook.rds")) %>%
  mutate(Year = as.integer(Exonerated)) %>%
  filter(!is.na(Year)) %>%
  count(Year) %>%
  rename(Count = n) %>%
  mutate(Data = "Exonerations")

crime <- read_rds(here("dataset-ignore", "crime_data_2010.rds")) %>%
  count(Year) %>%
  rename(Count = n) %>%
  mutate(Data = "Crimes")

combined <- bind_rows(exon, crime)

# Side-by-side with free y-scales
ggplot(combined, aes(x = Year, y = Count)) +
  geom_line() +
  geom_point() +
  facet_wrap(~ Data, scales = "free_y", ncol = 2) +
  labs(
    title = "Cook County: Crimes vs. Exonerations Over Time",
    x = "Year",
    y = "Count"
  ) +
  theme_minimal()

```




